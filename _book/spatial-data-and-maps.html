<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Spatial Data and Maps | Introduction to Environmental Data Science</title>
  <meta name="description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data abstraction, transformation, data analysis, spatial data/mapping, statistical modeling, and time series, applied to environmental research. Applies exploratory data analysis methods and tidyverse approaches in R, and includes contributed chapters presenting research applications, with associated data and code packages." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Spatial Data and Maps | Introduction to Environmental Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data abstraction, transformation, data analysis, spatial data/mapping, statistical modeling, and time series, applied to environmental research. Applies exploratory data analysis methods and tidyverse approaches in R, and includes contributed chapters presenting research applications, with associated data and code packages." />
  <meta name="github-repo" content="iGISc/EnvDataSci" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Spatial Data and Maps | Introduction to Environmental Data Science" />
  
  <meta name="twitter:description" content="Background, concepts and exercises for using R for environmental data science. The focus is on applying the R language and various libraries for data abstraction, transformation, data analysis, spatial data/mapping, statistical modeling, and time series, applied to environmental research. Applies exploratory data analysis methods and tidyverse approaches in R, and includes contributed chapters presenting research applications, with associated data and code packages." />
  



<meta name="date" content="2021-07-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-transformation.html"/>
<link rel="next" href="statistical-summaries-and-tests.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/ndvi_5cad19-1/data_stars_ndvi584b19.txt"></script>
<script src="libs/joda-0.0.1/joda.js"></script>
<script src="libs/joda-0.0.1/addImageQuery-bindings.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<script src="libs/predict_svm_201dc7-1/data_stars_predict_svm47652f.txt"></script>
<script src="libs/predict_rf_bfde18-1/data_stars_predict_rf3d85f6.txt"></script>
<script src="libs/predict_nnet_3dbc85-1/data_stars_predict_nnet638bc7.txt"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Environmental Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#environmental-data-and-methods"><i class="fa fa-check"></i><b>1.1</b> Environmental Data and Methods</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#goals-of-this-book"><i class="fa fa-check"></i><b>1.2</b> Goals of this book</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#some-definitions"><i class="fa fa-check"></i><b>1.2.1</b> Some definitions:</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>1.3</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#software-and-data-well-need"><i class="fa fa-check"></i><b>1.4</b> Software and data we’ll need</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.4.1</b> Data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I R for Exploratory Data Analysis</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>2.2</b> Functions</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#expressions-and-statements"><i class="fa fa-check"></i><b>2.3</b> Expressions and Statements</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-types"><i class="fa fa-check"></i><b>2.4</b> Data Types</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#integers"><i class="fa fa-check"></i><b>2.4.1</b> Integers</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rectangular-data"><i class="fa fa-check"></i><b>2.5</b> Rectangular data</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-structures-in-r"><i class="fa fa-check"></i><b>2.6</b> Data Structures in R</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#lists"><i class="fa fa-check"></i><b>2.6.2</b> Lists</a></li>
<li class="chapter" data-level="2.6.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#matrices"><i class="fa fa-check"></i><b>2.6.3</b> Matrices</a></li>
<li class="chapter" data-level="2.6.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frames"><i class="fa fa-check"></i><b>2.6.4</b> Data frames</a></li>
<li class="chapter" data-level="2.6.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#factors"><i class="fa fa-check"></i><b>2.6.5</b> Factors</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#programming-scripts-in-rstudio"><i class="fa fa-check"></i><b>2.7</b> Programming scripts in RStudio</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#subsetting-with-logic"><i class="fa fa-check"></i><b>2.7.1</b> Subsetting with logic</a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#apply-functions"><i class="fa fa-check"></i><b>2.7.2</b> Apply functions</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#exercises"><i class="fa fa-check"></i><b>2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-abstraction.html"><a href="data-abstraction.html"><i class="fa fa-check"></i><b>3</b> Data Abstraction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-abstraction.html"><a href="data-abstraction.html#background-exploratory-data-analysis"><i class="fa fa-check"></i><b>3.1</b> Background: Exploratory Data Analysis</a></li>
<li class="chapter" data-level="3.2" data-path="data-abstraction.html"><a href="data-abstraction.html#the-tidyverse-and-what-well-explore-in-this-chapter"><i class="fa fa-check"></i><b>3.2</b> The Tidyverse and what we’ll explore in this chapter</a></li>
<li class="chapter" data-level="3.3" data-path="data-abstraction.html"><a href="data-abstraction.html#tibbles"><i class="fa fa-check"></i><b>3.3</b> Tibbles</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-abstraction.html"><a href="data-abstraction.html#read_csv-vs.-read.csv"><i class="fa fa-check"></i><b>3.3.1</b> <code>read_csv</code> vs. <code>read.csv</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-abstraction.html"><a href="data-abstraction.html#statistical-summary-of-variables"><i class="fa fa-check"></i><b>3.4</b> Statistical summary of variables</a></li>
<li class="chapter" data-level="3.5" data-path="data-abstraction.html"><a href="data-abstraction.html#visualizing-data-with-a-tukey-box-plot"><i class="fa fa-check"></i><b>3.5</b> Visualizing data with a Tukey box plot</a></li>
<li class="chapter" data-level="3.6" data-path="data-abstraction.html"><a href="data-abstraction.html#database-operations-with-dplyr"><i class="fa fa-check"></i><b>3.6</b> Database operations with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-abstraction.html"><a href="data-abstraction.html#select-mutate-and-the-pipe"><i class="fa fa-check"></i><b>3.6.1</b> Select, mutate, and the pipe</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-abstraction.html"><a href="data-abstraction.html#filter"><i class="fa fa-check"></i><b>3.6.2</b> filter</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-abstraction.html"><a href="data-abstraction.html#writing-a-data-frame-to-a-csv"><i class="fa fa-check"></i><b>3.6.3</b> Writing a data frame to a csv</a></li>
<li class="chapter" data-level="3.6.4" data-path="data-abstraction.html"><a href="data-abstraction.html#summarize-by-group"><i class="fa fa-check"></i><b>3.6.4</b> Summarize by group</a></li>
<li class="chapter" data-level="3.6.5" data-path="data-abstraction.html"><a href="data-abstraction.html#count"><i class="fa fa-check"></i><b>3.6.5</b> Count</a></li>
<li class="chapter" data-level="3.6.6" data-path="data-abstraction.html"><a href="data-abstraction.html#sorting-after-summarizing"><i class="fa fa-check"></i><b>3.6.6</b> Sorting after summarizing</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-abstraction.html"><a href="data-abstraction.html#the-dot-operator"><i class="fa fa-check"></i><b>3.7</b> The dot operator</a></li>
<li class="chapter" data-level="3.8" data-path="data-abstraction.html"><a href="data-abstraction.html#exercises-1"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
<li class="chapter" data-level="3.9" data-path="data-abstraction.html"><a href="data-abstraction.html#string-abstraction"><i class="fa fa-check"></i><b>3.9</b> String Abstraction</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="data-abstraction.html"><a href="data-abstraction.html#detecting-matches"><i class="fa fa-check"></i><b>3.9.1</b> Detecting matches</a></li>
<li class="chapter" data-level="3.9.2" data-path="data-abstraction.html"><a href="data-abstraction.html#subsetting-strings"><i class="fa fa-check"></i><b>3.9.2</b> Subsetting Strings</a></li>
<li class="chapter" data-level="3.9.3" data-path="data-abstraction.html"><a href="data-abstraction.html#string-length"><i class="fa fa-check"></i><b>3.9.3</b> String Length</a></li>
<li class="chapter" data-level="3.9.4" data-path="data-abstraction.html"><a href="data-abstraction.html#replacing-substrings-with-other-text-mutating-strings"><i class="fa fa-check"></i><b>3.9.4</b> Replacing substrings with other text (“mutating” strings)</a></li>
<li class="chapter" data-level="3.9.5" data-path="data-abstraction.html"><a href="data-abstraction.html#concatenating-and-splitting"><i class="fa fa-check"></i><b>3.9.5</b> Concatenating and splitting</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="data-abstraction.html"><a href="data-abstraction.html#dates-and-times-with-lubridate"><i class="fa fa-check"></i><b>3.10</b> Dates and times with <code>lubridate</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>4</b> Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualization.html"><a href="visualization.html#ggplot2"><i class="fa fa-check"></i><b>4.1</b> ggplot2</a></li>
<li class="chapter" data-level="4.2" data-path="visualization.html"><a href="visualization.html#plotting-one-variable"><i class="fa fa-check"></i><b>4.2</b> Plotting one variable</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visualization.html"><a href="visualization.html#histogram"><i class="fa fa-check"></i><b>4.2.1</b> Histogram</a></li>
<li class="chapter" data-level="4.2.2" data-path="visualization.html"><a href="visualization.html#density-plot"><i class="fa fa-check"></i><b>4.2.2</b> Density Plot</a></li>
<li class="chapter" data-level="4.2.3" data-path="visualization.html"><a href="visualization.html#boxplot"><i class="fa fa-check"></i><b>4.2.3</b> boxplot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visualization.html"><a href="visualization.html#plotting-two-variables"><i class="fa fa-check"></i><b>4.3</b> Plotting two variables</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visualization.html"><a href="visualization.html#two-continuous-variables"><i class="fa fa-check"></i><b>4.3.1</b> Two continuous variables</a></li>
<li class="chapter" data-level="4.3.2" data-path="visualization.html"><a href="visualization.html#two-variables-one-discrete"><i class="fa fa-check"></i><b>4.3.2</b> Two variables, one discrete</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visualization.html"><a href="visualization.html#color-systems"><i class="fa fa-check"></i><b>4.4</b> Color systems</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="visualization.html"><a href="visualization.html#color-from-variable-in-aesthetics"><i class="fa fa-check"></i><b>4.4.1</b> Color from variable, in aesthetics</a></li>
<li class="chapter" data-level="4.4.2" data-path="visualization.html"><a href="visualization.html#trend-line"><i class="fa fa-check"></i><b>4.4.2</b> Trend line</a></li>
<li class="chapter" data-level="4.4.3" data-path="visualization.html"><a href="visualization.html#general-symbology"><i class="fa fa-check"></i><b>4.4.3</b> General symbology</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="visualization.html"><a href="visualization.html#titles-and-subtitles"><i class="fa fa-check"></i><b>4.5</b> Titles and subtitles</a></li>
<li class="chapter" data-level="4.6" data-path="visualization.html"><a href="visualization.html#pairs-plot"><i class="fa fa-check"></i><b>4.6</b> Pairs Plot</a></li>
<li class="chapter" data-level="4.7" data-path="visualization.html"><a href="visualization.html#exercises-2"><i class="fa fa-check"></i><b>4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>5</b> Data Transformation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-transformation.html"><a href="data-transformation.html#data-joins"><i class="fa fa-check"></i><b>5.1</b> Data joins</a></li>
<li class="chapter" data-level="5.2" data-path="data-transformation.html"><a href="data-transformation.html#set-operations"><i class="fa fa-check"></i><b>5.2</b> Set Operations</a></li>
<li class="chapter" data-level="5.3" data-path="data-transformation.html"><a href="data-transformation.html#binding-rows-and-columns"><i class="fa fa-check"></i><b>5.3</b> Binding Rows and Columns</a></li>
<li class="chapter" data-level="5.4" data-path="data-transformation.html"><a href="data-transformation.html#pivotting-data-frames"><i class="fa fa-check"></i><b>5.4</b> Pivotting data frames</a></li>
</ul></li>
<li class="part"><span><b>II Spatial</b></span></li>
<li class="chapter" data-level="6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html"><i class="fa fa-check"></i><b>6</b> Spatial Data and Maps</a>
<ul>
<li class="chapter" data-level="6.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#spatial-data"><i class="fa fa-check"></i><b>6.1</b> Spatial Data</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#examples-of-simple-geometry-building-in-sf"><i class="fa fa-check"></i><b>6.1.1</b> Examples of simple geometry building in sf</a></li>
<li class="chapter" data-level="6.1.2" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#building-a-mappable-sfc-from-scratch"><i class="fa fa-check"></i><b>6.1.2</b> Building a mappable sfc from scratch</a></li>
<li class="chapter" data-level="6.1.3" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#creating-features-from-shapefiles-or-tables"><i class="fa fa-check"></i><b>6.1.3</b> Creating features from shapefiles or tables</a></li>
<li class="chapter" data-level="6.1.4" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#coordinate-referencing-system"><i class="fa fa-check"></i><b>6.1.4</b> Coordinate Referencing System</a></li>
<li class="chapter" data-level="6.1.5" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#spatial-join-st_join"><i class="fa fa-check"></i><b>6.1.5</b> Spatial join <code>st_join</code></a></li>
<li class="chapter" data-level="6.1.6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#plotting-maps-in-the-base-plot-system"><i class="fa fa-check"></i><b>6.1.6</b> Plotting maps in the base plot system</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#raster-gis-in-r"><i class="fa fa-check"></i><b>6.2</b> Raster GIS in R</a></li>
<li class="chapter" data-level="6.3" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#ggplot2-for-maps"><i class="fa fa-check"></i><b>6.3</b> ggplot2 for maps</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#rasters-in-ggplot2"><i class="fa fa-check"></i><b>6.3.1</b> Rasters in ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#tmap"><i class="fa fa-check"></i><b>6.4</b> tmap</a></li>
<li class="chapter" data-level="6.5" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#interactive-maps"><i class="fa fa-check"></i><b>6.5</b> Interactive Maps</a></li>
<li class="chapter" data-level="6.6" data-path="spatial-data-and-maps.html"><a href="spatial-data-and-maps.html#exercises-3"><i class="fa fa-check"></i><b>6.6</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>III Statistics &amp; Modeling</b></span></li>
<li class="chapter" data-level="7" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html"><i class="fa fa-check"></i><b>7</b> Statistical Summaries and Tests</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#goals-of-statistical-analysis"><i class="fa fa-check"></i><b>7.1</b> Goals of statistical analysis</a></li>
<li class="chapter" data-level="7.2" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#summary-statistics"><i class="fa fa-check"></i><b>7.2</b> Summary Statistics</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#summarize-by-group-stratifying-a-summary"><i class="fa fa-check"></i><b>7.2.1</b> Summarize by group: <em>stratifying a summary</em></a></li>
<li class="chapter" data-level="7.2.2" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#boxplot-for-visualizing-distributions-by-group"><i class="fa fa-check"></i><b>7.2.2</b> Boxplot for visualizing distributions by group</a></li>
<li class="chapter" data-level="7.2.3" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#generating-pseudorandom-numbers"><i class="fa fa-check"></i><b>7.2.3</b> Generating pseudorandom numbers</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#statistical-tests"><i class="fa fa-check"></i><b>7.3</b> Statistical tests</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#comparing-samples-and-groupings"><i class="fa fa-check"></i><b>7.3.1</b> Comparing samples and groupings</a></li>
<li class="chapter" data-level="7.3.2" data-path="statistical-summaries-and-tests.html"><a href="statistical-summaries-and-tests.html#correlation"><i class="fa fa-check"></i><b>7.3.2</b> Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-in-r.html"><a href="modeling-in-r.html"><i class="fa fa-check"></i><b>8</b> Modeling in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modeling-in-r.html"><a href="modeling-in-r.html#some-common-statistical-models"><i class="fa fa-check"></i><b>8.1</b> Some common statistical models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="modeling-in-r.html"><a href="modeling-in-r.html#analysis-of-covariance"><i class="fa fa-check"></i><b>8.1.1</b> Analysis of Covariance</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modeling-in-r.html"><a href="modeling-in-r.html#generalized-linear-model-glm"><i class="fa fa-check"></i><b>8.2</b> Generalized Linear Model (GLM)</a></li>
<li class="chapter" data-level="8.3" data-path="modeling-in-r.html"><a href="modeling-in-r.html#models-employing-machine-learning"><i class="fa fa-check"></i><b>8.3</b> Models Employing Machine Learning</a></li>
<li class="chapter" data-level="8.4" data-path="modeling-in-r.html"><a href="modeling-in-r.html#spatial-statistical-analysis"><i class="fa fa-check"></i><b>8.4</b> Spatial Statistical Analysis</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="modeling-in-r.html"><a href="modeling-in-r.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>8.4.1</b> Spatial Autocorrelation</a></li>
<li class="chapter" data-level="8.4.2" data-path="modeling-in-r.html"><a href="modeling-in-r.html#mapping-residuals"><i class="fa fa-check"></i><b>8.4.2</b> Mapping Residuals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html"><i class="fa fa-check"></i><b>9</b> Machine Learning for Imagery Classification</a>
<ul>
<li class="chapter" data-level="9.1" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#introduction"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#validation-creating-a-training-set-and-the-overfit-model-problem"><i class="fa fa-check"></i><b>9.1.1</b> Validation, creating a training set and the “overfit model” problem</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#methods"><i class="fa fa-check"></i><b>9.2</b> Methods</a></li>
<li class="chapter" data-level="9.3" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#read-all-10m-20m-bands-into-a-list-of-10-bands"><i class="fa fa-check"></i><b>9.3</b> Read all 10m &amp; 20m bands into a list of 10 bands</a></li>
<li class="chapter" data-level="9.4" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#visualize-the-original-imagery"><i class="fa fa-check"></i><b>9.4</b> Visualize the original imagery</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#visualize-the-image-in-false-color-ir-r-g-as-r-g-b."><i class="fa fa-check"></i><b>9.4.1</b> Visualize the image in false color (IR-R-G as R-G-B).</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#set-up-prediction-raster-brick"><i class="fa fa-check"></i><b>9.5</b> Set up prediction raster brick</a></li>
<li class="chapter" data-level="9.6" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#resample-20-m-bands-to-10-m"><i class="fa fa-check"></i><b>9.6</b> Resample 20 m bands to 10 m</a></li>
<li class="chapter" data-level="9.7" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#principle-component-analysis-pca"><i class="fa fa-check"></i><b>9.7</b> Principle Component Analysis (PCA)</a></li>
<li class="chapter" data-level="9.8" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#create-an-ndvi-raster"><i class="fa fa-check"></i><b>9.8</b> Create an NDVI raster</a></li>
<li class="chapter" data-level="9.9" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#normalize-center-scale-raster-images"><i class="fa fa-check"></i><b>9.9</b> Normalize (Center &amp; scale) raster images:</a></li>
<li class="chapter" data-level="9.10" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#create-the-same-aoi-that-was-used-to-crop-the-image-for-display-purposes"><i class="fa fa-check"></i><b>9.10</b> Create the same AOI that was used to crop the image, for display purposes</a></li>
<li class="chapter" data-level="9.11" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#training-polygons"><i class="fa fa-check"></i><b>9.11</b> Training polygons</a></li>
<li class="chapter" data-level="9.12" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#extract-training-values-from-polygons-at-10-m-resolution"><i class="fa fa-check"></i><b>9.12</b> Extract training values from polygons at 10 m resolution</a></li>
<li class="chapter" data-level="9.13" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#histograms-of-predictors"><i class="fa fa-check"></i><b>9.13</b> Histograms of predictors</a></li>
<li class="chapter" data-level="9.14" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#split-into-training-and-testing-subsets"><i class="fa fa-check"></i><b>9.14</b> Split into training and testing subsets</a></li>
<li class="chapter" data-level="9.15" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#fit-models"><i class="fa fa-check"></i><b>9.15</b> Fit models</a>
<ul>
<li class="chapter" data-level="9.15.1" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#set-up-model-training-controls-for-all-models"><i class="fa fa-check"></i><b>9.15.1</b> Set up model training controls (for all models)</a></li>
</ul></li>
<li class="chapter" data-level="9.16" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#support-vector-machine-svm-model"><i class="fa fa-check"></i><b>9.16</b> Support Vector Machine (SVM) model</a>
<ul>
<li class="chapter" data-level="9.16.1" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#train-svm-model"><i class="fa fa-check"></i><b>9.16.1</b> Train SVM model</a></li>
<li class="chapter" data-level="9.16.2" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#svm-model-summary-confusion-matrix"><i class="fa fa-check"></i><b>9.16.2</b> SVM model summary &amp; confusion matrix</a></li>
<li class="chapter" data-level="9.16.3" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#svm-variable-importance"><i class="fa fa-check"></i><b>9.16.3</b> SVM variable importance</a></li>
<li class="chapter" data-level="9.16.4" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#svm-prediction-map"><i class="fa fa-check"></i><b>9.16.4</b> SVM prediction map</a></li>
<li class="chapter" data-level="9.16.5" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#compare-training-vs-svm-predicted-cover"><i class="fa fa-check"></i><b>9.16.5</b> Compare training vs SVM predicted % cover</a></li>
</ul></li>
<li class="chapter" data-level="9.17" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#random-forest"><i class="fa fa-check"></i><b>9.17</b> Random Forest</a>
<ul>
<li class="chapter" data-level="9.17.1" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#rf-confusion-matrix"><i class="fa fa-check"></i><b>9.17.1</b> RF confusion matrix</a></li>
<li class="chapter" data-level="9.17.2" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#rf-predictor-importance"><i class="fa fa-check"></i><b>9.17.2</b> RF predictor importance</a></li>
</ul></li>
<li class="chapter" data-level="9.18" data-path="machine-learning-for-imagery-classification.html"><a href="machine-learning-for-imagery-classification.html#neural-network"><i class="fa fa-check"></i><b>9.18</b> Neural Network</a></li>
</ul></li>
<li class="part"><span><b>IV Time Series</b></span></li>
<li class="chapter" data-level="10" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html"><i class="fa fa-check"></i><b>10</b> Time Series Visualization &amp; Analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#creation-of-time-series-ts-data"><i class="fa fa-check"></i><b>10.1</b> Creation of time series (ts) data</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#frequency-setting"><i class="fa fa-check"></i><b>10.1.1</b> frequency setting</a></li>
<li class="chapter" data-level="10.1.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#data-logger-data-from-marble-mountains-resurgence"><i class="fa fa-check"></i><b>10.1.2</b> Data logger data from Marble Mountains resurgence</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#data-smoothing-methods"><i class="fa fa-check"></i><b>10.2</b> Data smoothing methods</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#moving-average-ma"><i class="fa fa-check"></i><b>10.2.1</b> moving average (ma)</a></li>
<li class="chapter" data-level="10.2.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#loess-local-regression-smoothing"><i class="fa fa-check"></i><b>10.2.2</b> loess (local regression) smoothing</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#decomposing-time-series"><i class="fa fa-check"></i><b>10.3</b> Decomposing time series</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#lag-regression"><i class="fa fa-check"></i><b>10.3.1</b> lag regression</a></li>
<li class="chapter" data-level="10.3.2" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#ensemble-average"><i class="fa fa-check"></i><b>10.3.2</b> Ensemble Average</a></li>
<li class="chapter" data-level="10.3.3" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#julian-dates"><i class="fa fa-check"></i><b>10.3.3</b> Julian Dates</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="time-series-visualization-analysis.html"><a href="time-series-visualization-analysis.html#learning-more-about-time-series-in-r"><i class="fa fa-check"></i><b>10.4</b> Learning more about time series in R</a></li>
</ul></li>
<li class="part"><span><b>V Communication &amp; Special Topics</b></span></li>
<li class="chapter" data-level="11" data-path="communication.html"><a href="communication.html"><i class="fa fa-check"></i><b>11</b> Communication</a></li>
<li class="chapter" data-level="" data-path="appendix-building-a-data-package-for-github.html"><a href="appendix-building-a-data-package-for-github.html"><i class="fa fa-check"></i>Appendix: Building a Data Package for GitHub</a>
<ul>
<li><a href="appendix-building-a-data-package-for-github.html#rda-files"><code>rda</code> files</a>
<ul>
<li><a href="appendix-building-a-data-package-for-github.html#usethisuse_data"><code>usethis::use_data()</code></a></li>
<li><a href="appendix-building-a-data-package-for-github.html#usethiscreate_package"><code>usethis::create_package()</code></a></li>
<li><a href="appendix-building-a-data-package-for-github.html#devtoolsdocument"><code>devtools::document()</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-building-a-data-package-for-github.html"><a href="appendix-building-a-data-package-for-github.html#raw-data"><i class="fa fa-check"></i>Raw data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Environmental Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-data-and-maps" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Spatial Data and Maps</h1>
<p>We’ll explore the basics of simple features (sf) for building spatial datasets, then some common mapping methods:</p>
<ul>
<li>ggplot2</li>
<li>tmap</li>
<li>leaflet</li>
<li>the base plot system occasionally</li>
<li>something else</li>
</ul>
<div id="spatial-data" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Spatial Data</h2>
<p>To work with spatial data requires extending R to deal with it using packages. Many have been developed, but the field is starting to mature using international open GIS standards.</p>
<p><strong><code>sp</code></strong> (until recently, the dominant library of spatial tools)</p>
<ul>
<li>Includes functions for working with spatial data</li>
<li>Includes <code>spplot</code> to create maps</li>
<li>Also needs <code>rgdal</code> package for <code>readOGR</code> – reads spatial data frames.</li>
</ul>
<p><strong><code>sf</code></strong> (Simple Features)</p>
<ul>
<li>ISO 19125 standard for GIS geometries</li>
<li>Also has functions for working with spatial data, but clearer to use.</li>
<li>Doesn’t need many additional packages, though you may still need <code>rgdal</code> installed for some tools you want to use.</li>
<li>Replacing <code>sp</code> and <code>spplot</code> though you’ll still find them in code. We’ll give it a try…</li>
<li>Works with ggplot2 and tmap for nice looking maps.</li>
</ul>
<p>Cheat sheet: <a href="https://github.com/rstudio/cheatsheets/raw/master/sf.pdf" class="uri">https://github.com/rstudio/cheatsheets/raw/master/sf.pdf</a></p>
<div id="simple-feature-geometry-sfg-and-simple-feature-column-sfc" class="section level4" number="6.1.0.1">
<h4><span class="header-section-number">6.1.0.1</span> simple feature geometry sfg and simple feature column sfc</h4>
</div>
<div id="examples-of-simple-geometry-building-in-sf" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Examples of simple geometry building in sf</h3>
<p>sf functions have the pattern st_*</p>
<p>st means “space and time”</p>
<p>See Geocomputation with R at <a href="https://geocompr.robinlovelace.net/" class="uri">https://geocompr.robinlovelace.net/</a> or <a href="https://r-spatial.github.io/sf/" class="uri">https://r-spatial.github.io/sf/</a>
for more details, but here’s an example of manual feature creation of sf geometries (sfg):</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="spatial-data-and-maps.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb333-2"><a href="spatial-data-and-maps.html#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb333-3"><a href="spatial-data-and-maps.html#cb333-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iGIScData)</span></code></pre></div>
<p>[As usual, go to the relevant project, in this case <strong><code>generic_methods</code></strong>]</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="spatial-data-and-maps.html#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb334-2"><a href="spatial-data-and-maps.html#cb334-2" aria-hidden="true" tabindex="-1"></a>eyes <span class="ot">&lt;-</span> <span class="fu">st_multipoint</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)))</span>
<span id="cb334-3"><a href="spatial-data-and-maps.html#cb334-3" aria-hidden="true" tabindex="-1"></a>nose <span class="ot">&lt;-</span> <span class="fu">st_point</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb334-4"><a href="spatial-data-and-maps.html#cb334-4" aria-hidden="true" tabindex="-1"></a>mouth <span class="ot">&lt;-</span> <span class="fu">st_linestring</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>)))</span>
<span id="cb334-5"><a href="spatial-data-and-maps.html#cb334-5" aria-hidden="true" tabindex="-1"></a>border <span class="ot">&lt;-</span> <span class="fu">st_polygon</span>(<span class="fu">list</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>), </span>
<span id="cb334-6"><a href="spatial-data-and-maps.html#cb334-6" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>), <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>))))</span>
<span id="cb334-7"><a href="spatial-data-and-maps.html#cb334-7" aria-hidden="true" tabindex="-1"></a>face <span class="ot">&lt;-</span> <span class="fu">st_sfc</span>(eyes, nose, mouth, border)  <span class="co"># sfc = sf column </span></span>
<span id="cb334-8"><a href="spatial-data-and-maps.html#cb334-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(face)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-45"></span>
<img src="EnvDataSci_files/figure-html/unnamed-chunk-45-1.png" alt="Building simple geometries in sf" width="672" />
<p class="caption">
Figure 6.1: Building simple geometries in sf
</p>
</div>
<p>The face was a simple feature column (sfc) built from the list of sfgs.
An sfc just has the one column, so is not quite like a shapefile.</p>
<ul>
<li>But it can have a coordinate referencing system CRS, and so can be mapped.</li>
<li>Kind of like a shapefile with no other attributes than shape</li>
</ul>
<p>[<strong><code>westUS</code></strong>]</p>
</div>
<div id="building-a-mappable-sfc-from-scratch" class="section level3" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Building a mappable sfc from scratch</h3>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="spatial-data-and-maps.html#cb335-1" aria-hidden="true" tabindex="-1"></a>CA_matrix <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">124</span>,<span class="dv">42</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">120</span>,<span class="dv">42</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">120</span>,<span class="dv">39</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="fl">114.5</span>,<span class="dv">35</span>),</span>
<span id="cb335-2"><a href="spatial-data-and-maps.html#cb335-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="sc">-</span><span class="fl">114.1</span>,<span class="fl">34.3</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="fl">114.6</span>,<span class="fl">32.7</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">117</span>,<span class="fl">32.5</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="fl">118.5</span>,<span class="dv">34</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="fl">120.5</span>,<span class="fl">34.5</span>),</span>
<span id="cb335-3"><a href="spatial-data-and-maps.html#cb335-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="sc">-</span><span class="dv">122</span>,<span class="fl">36.5</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="fl">121.8</span>,<span class="fl">36.8</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">122</span>,<span class="dv">37</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="fl">122.4</span>,<span class="fl">37.3</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="fl">122.5</span>,<span class="fl">37.8</span>),</span>
<span id="cb335-4"><a href="spatial-data-and-maps.html#cb335-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="sc">-</span><span class="dv">123</span>,<span class="dv">38</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="fl">123.7</span>,<span class="dv">39</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">124</span>,<span class="dv">40</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="fl">124.4</span>,<span class="fl">40.5</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">124</span>,<span class="dv">41</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">124</span>,<span class="dv">42</span>))</span>
<span id="cb335-5"><a href="spatial-data-and-maps.html#cb335-5" aria-hidden="true" tabindex="-1"></a>NV_matrix <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">120</span>,<span class="dv">42</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">114</span>,<span class="dv">42</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">114</span>,<span class="dv">36</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="fl">114.5</span>,<span class="dv">36</span>),</span>
<span id="cb335-6"><a href="spatial-data-and-maps.html#cb335-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="sc">-</span><span class="fl">114.5</span>,<span class="dv">35</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">120</span>,<span class="dv">39</span>),<span class="fu">c</span>(<span class="sc">-</span><span class="dv">120</span>,<span class="dv">42</span>))</span>
<span id="cb335-7"><a href="spatial-data-and-maps.html#cb335-7" aria-hidden="true" tabindex="-1"></a>CA_list <span class="ot">&lt;-</span> <span class="fu">list</span>(CA_matrix);       NV_list <span class="ot">&lt;-</span> <span class="fu">list</span>(NV_matrix)</span>
<span id="cb335-8"><a href="spatial-data-and-maps.html#cb335-8" aria-hidden="true" tabindex="-1"></a>CA_poly <span class="ot">&lt;-</span> <span class="fu">st_polygon</span>(CA_list);   NV_poly <span class="ot">&lt;-</span> <span class="fu">st_polygon</span>(NV_list)</span>
<span id="cb335-9"><a href="spatial-data-and-maps.html#cb335-9" aria-hidden="true" tabindex="-1"></a>sfc_2states <span class="ot">&lt;-</span> <span class="fu">st_sfc</span>(CA_poly,NV_poly,<span class="at">crs=</span><span class="dv">4326</span>)  <span class="co"># crs=4326 specifies GCS</span></span>
<span id="cb335-10"><a href="spatial-data-and-maps.html#cb335-10" aria-hidden="true" tabindex="-1"></a><span class="fu">st_geometry_type</span>(sfc_2states)</span></code></pre></div>
<pre><code>## [1] POLYGON POLYGON
## 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT MULTILINESTRING ... TRIANGLE</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="spatial-data-and-maps.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb337-2"><a href="spatial-data-and-maps.html#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">data =</span> sfc_2states)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-46"></span>
<img src="EnvDataSci_files/figure-html/unnamed-chunk-46-1.png" alt="A simple map built from scratch with hard-coded data as simple feature columns" width="672" />
<p class="caption">
Figure 6.2: A simple map built from scratch with hard-coded data as simple feature columns
</p>
</div>
<p><strong>sf class</strong></p>
<p>Is like a shapefile: has attributes to which geometry is added, and can be used like a data frame.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="spatial-data-and-maps.html#cb338-1" aria-hidden="true" tabindex="-1"></a>attributes <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="fu">c</span>(<span class="at">abb=</span><span class="st">&quot;CA&quot;</span>, <span class="at">area=</span><span class="dv">423970</span>, <span class="at">pop=</span><span class="fl">39.56e6</span>),</span>
<span id="cb338-2"><a href="spatial-data-and-maps.html#cb338-2" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">c</span>(<span class="at">abb=</span><span class="st">&quot;NV&quot;</span>, <span class="at">area=</span><span class="dv">286382</span>, <span class="at">pop=</span><span class="fl">3.03e6</span>))</span>
<span id="cb338-3"><a href="spatial-data-and-maps.html#cb338-3" aria-hidden="true" tabindex="-1"></a>twostates <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(attributes, <span class="at">geometry =</span> sfc_2states)</span>
<span id="cb338-4"><a href="spatial-data-and-maps.html#cb338-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(twostates) <span class="sc">+</span> <span class="fu">geom_sf</span>() <span class="sc">+</span> <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> abb))</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-47"></span>
<img src="EnvDataSci_files/figure-html/unnamed-chunk-47-1.png" alt="Using an sf class to build a map, displaying an attribute" width="672" />
<p class="caption">
Figure 6.3: Using an sf class to build a map, displaying an attribute
</p>
</div>
</div>
<div id="creating-features-from-shapefiles-or-tables" class="section level3" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Creating features from shapefiles or tables</h3>
<p><strong>sf’s <code>st_read</code> reads shapefiles</strong></p>
<ul>
<li>shapefile is an open GIS format for points, polylines, polygons</li>
</ul>
<p>You would normally have shapefiles (and all the files that go with them – .shx, etc.)
stored on your computer, but we’ll access one from the iGIScData external data folder [<strong><code>sierra</code></strong>]:</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="spatial-data-and-maps.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iGIScData)</span>
<span id="cb339-2"><a href="spatial-data-and-maps.html#cb339-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb339-3"><a href="spatial-data-and-maps.html#cb339-3" aria-hidden="true" tabindex="-1"></a>shpPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;CA_counties.shp&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb339-4"><a href="spatial-data-and-maps.html#cb339-4" aria-hidden="true" tabindex="-1"></a>CA_counties <span class="ot">&lt;-</span> <span class="fu">st_read</span>(shpPath)</span></code></pre></div>
<pre><code>## Reading layer `CA_counties&#39; from data source 
##   `C:\Users\900008452\Documents\R\win-library\4.0\iGIScData\extdata\CA_counties.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 58 features and 60 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -124.4152 ymin: 32.53427 xmax: -114.1312 ymax: 42.00952
## Geodetic CRS:  WGS 84</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="spatial-data-and-maps.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CA_counties)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p><strong><code>st_as_sf</code> converts data frames</strong></p>
<ul>
<li>using coordinates read from x and y variables, with crs set to coordinate system (4326 for GCS)</li>
</ul>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="spatial-data-and-maps.html#cb342-1" aria-hidden="true" tabindex="-1"></a>sierraFebpts <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(sierraFeb, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;LONGITUDE&quot;</span>, <span class="st">&quot;LATITUDE&quot;</span>), <span class="at">crs=</span><span class="dv">4326</span>)</span>
<span id="cb342-2"><a href="spatial-data-and-maps.html#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sierraFebpts)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p>[<strong><code>air_quality</code></strong>]
[Leave out: need new BayAreaTracts data]</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="spatial-data-and-maps.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidyverse)</span></span>
<span id="cb343-2"><a href="spatial-data-and-maps.html#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(sf)</span></span>
<span id="cb343-3"><a href="spatial-data-and-maps.html#cb343-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(iGIScData)</span></span>
<span id="cb343-4"><a href="spatial-data-and-maps.html#cb343-4" aria-hidden="true" tabindex="-1"></a><span class="co"># censusCentroids &lt;- st_centroid(BayAreaTracts)</span></span>
<span id="cb343-5"><a href="spatial-data-and-maps.html#cb343-5" aria-hidden="true" tabindex="-1"></a><span class="co"># TRI_sp &lt;- st_as_sf(TRI_2017_CA, coords = c(&quot;LONGITUDE&quot;, &quot;LATITUDE&quot;), </span></span>
<span id="cb343-6"><a href="spatial-data-and-maps.html#cb343-6" aria-hidden="true" tabindex="-1"></a><span class="co">#         crs=4326) # simple way to specify coordinate reference</span></span>
<span id="cb343-7"><a href="spatial-data-and-maps.html#cb343-7" aria-hidden="true" tabindex="-1"></a><span class="co"># bnd &lt;- st_bbox(censusCentroids)</span></span>
<span id="cb343-8"><a href="spatial-data-and-maps.html#cb343-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot() +</span></span>
<span id="cb343-9"><a href="spatial-data-and-maps.html#cb343-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = BayAreaCounties, aes(fill = NAME)) +</span></span>
<span id="cb343-10"><a href="spatial-data-and-maps.html#cb343-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = censusCentroids) +</span></span>
<span id="cb343-11"><a href="spatial-data-and-maps.html#cb343-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = CAfreeways, color = &quot;grey&quot;) +</span></span>
<span id="cb343-12"><a href="spatial-data-and-maps.html#cb343-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = TRI_sp, color = &quot;yellow&quot;) +</span></span>
<span id="cb343-13"><a href="spatial-data-and-maps.html#cb343-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   coord_sf(xlim = c(bnd[1], bnd[3]), ylim = c(bnd[2], bnd[4])) +</span></span>
<span id="cb343-14"><a href="spatial-data-and-maps.html#cb343-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title=&quot;Bay Area Counties, Freeways and Census Tract Centroids&quot;)</span></span></code></pre></div>
</div>
<div id="coordinate-referencing-system" class="section level3" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> Coordinate Referencing System</h3>
<p>Say you have data you need to make spatial with a spatial reference</p>
<p><code>sierra &lt;- read_csv("sierraClimate.csv")</code></p>
<p>EPSG or CRS codes are an easy way to provide coordinate referencing.</p>
<p>Two ways of doing the same thing.</p>
<ol style="list-style-type: decimal">
<li>Spell it out:</li>
</ol>
<pre><code>GCS &lt;- &quot;+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0&quot;
wsta = st_as_sf(sierra, coords = c(&quot;LONGITUDE&quot;,&quot;LATITUDE&quot;), crs=GCS)</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Google to find the code you need and assign it to the crs parameter:</li>
</ol>
<p><code>wsta &lt;- st_as_sf(sierra, coords = c("LONGITUDE","LATITUDE"), crs=4326)</code></p>
<div id="removing-geometry" class="section level4" number="6.1.4.1">
<h4><span class="header-section-number">6.1.4.1</span> <em>Removing</em> Geometry</h4>
<p>There are many instances where you want to remove geometry from a sf data frame</p>
<ul>
<li><p>Some R functions run into problems with geometry and produce confusing error messages, like “non-numeric argument”</p></li>
<li><p>You’re wanting to work with an sf data frame in a non-spatial way</p></li>
</ul>
<p>One way to remove geometry:</p>
<p><code>myNonSFdf &lt;- mySFdf %&gt;% st_set_geometry(NULL)</code></p>
</div>
</div>
<div id="spatial-join-st_join" class="section level3" number="6.1.5">
<h3><span class="header-section-number">6.1.5</span> Spatial join <code>st_join</code></h3>
<p>A spatial join with st_join
joins data from census where TRI points occur [<strong><code>air_quality</code></strong>]
[left out: need new BayAreaTracts]</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="spatial-data-and-maps.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TRI_sp &lt;- st_as_sf(TRI_2017_CA, coords = c(&quot;LONGITUDE&quot;, &quot;LATITUDE&quot;), crs=4326) %&gt;%</span></span>
<span id="cb345-2"><a href="spatial-data-and-maps.html#cb345-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#st_join(BayAreaTracts) %&gt;%</span></span>
<span id="cb345-3"><a href="spatial-data-and-maps.html#cb345-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(CNTY_FIPS %in% c(&quot;013&quot;, &quot;095&quot;))</span></span></code></pre></div>
</div>
<div id="plotting-maps-in-the-base-plot-system" class="section level3" number="6.1.6">
<h3><span class="header-section-number">6.1.6</span> Plotting maps in the base plot system</h3>
<p>There are various programs for creating maps from spatial data, and we’ll look at a few after we’ve looked at rasters. As usual, the base plot system often does something useful when you give it data.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="spatial-data-and-maps.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(BayAreaCounties)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>And with just one variable:</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="spatial-data-and-maps.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(BayAreaCounties[<span class="st">&quot;POP_SQMI&quot;</span>])</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<p>There’s a lot more we could do with the base plot system, but we’ll mostly focus on
some better options in ggplot2 and tmap.</p>
</div>
</div>
<div id="raster-gis-in-r" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Raster GIS in R</h2>
<p>Simple <em>Features</em> are feature-based, of course, so it’s not surprising that sf doesn’t have support for rasters. So we’ll want to use the raster package.</p>
<p>We can start by building one from scratch:</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="spatial-data-and-maps.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb348-2"><a href="spatial-data-and-maps.html#cb348-2" aria-hidden="true" tabindex="-1"></a>new_ras <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">nrows =</span> <span class="dv">10</span>, <span class="at">ncols =</span> <span class="dv">10</span>, </span>
<span id="cb348-3"><a href="spatial-data-and-maps.html#cb348-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">xmn =</span> <span class="dv">0</span>, <span class="at">xmx =</span> <span class="dv">100</span>, <span class="at">ymn =</span> <span class="dv">0</span>, <span class="at">ymx =</span> <span class="dv">100</span>,</span>
<span id="cb348-4"><a href="spatial-data-and-maps.html#cb348-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">vals =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb348-5"><a href="spatial-data-and-maps.html#cb348-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(new_ras)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p><strong>A bit of raster reading and map algebra with Marble Mountains elevation data [<code>marbles</code>]</strong></p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="spatial-data-and-maps.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb349-2"><a href="spatial-data-and-maps.html#cb349-2" aria-hidden="true" tabindex="-1"></a>rasPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;elev.tif&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb349-3"><a href="spatial-data-and-maps.html#cb349-3" aria-hidden="true" tabindex="-1"></a>elev <span class="ot">&lt;-</span> <span class="fu">raster</span>(rasPath)</span>
<span id="cb349-4"><a href="spatial-data-and-maps.html#cb349-4" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="fu">terrain</span>(elev, <span class="at">opt=</span><span class="st">&quot;slope&quot;</span>)</span>
<span id="cb349-5"><a href="spatial-data-and-maps.html#cb349-5" aria-hidden="true" tabindex="-1"></a>aspect <span class="ot">&lt;-</span> <span class="fu">terrain</span>(elev, <span class="at">opt=</span><span class="st">&quot;aspect&quot;</span>)</span>
<span id="cb349-6"><a href="spatial-data-and-maps.html#cb349-6" aria-hidden="true" tabindex="-1"></a>slopeclasses <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="dv">1</span>, <span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="dv">2</span>, <span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="dv">3</span>,</span>
<span id="cb349-7"><a href="spatial-data-and-maps.html#cb349-7" aria-hidden="true" tabindex="-1"></a>                        <span class="fl">0.6</span>,<span class="fl">0.8</span>,<span class="dv">4</span>, <span class="fl">0.8</span>,<span class="dv">1</span>,<span class="dv">5</span>), <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb349-8"><a href="spatial-data-and-maps.html#cb349-8" aria-hidden="true" tabindex="-1"></a>slopeclass <span class="ot">&lt;-</span> <span class="fu">reclassify</span>(slope, <span class="at">rcl =</span> slopeclasses)</span>
<span id="cb349-9"><a href="spatial-data-and-maps.html#cb349-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-10"><a href="spatial-data-and-maps.html#cb349-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(elev)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="spatial-data-and-maps.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(slope)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-55-2.png" width="672" /></p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="spatial-data-and-maps.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(slopeclass)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-55-3.png" width="672" /></p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="spatial-data-and-maps.html#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aspect)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-55-4.png" width="672" /></p>
<p><strong>Sinking Cove, Tennessee</strong> is a karst valley system carved into the Cumberland Plateau, a nice place to see the use of a hillshade raster created from a digital elevation model using raster functions for slope, aspect, and hillshade:</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="spatial-data-and-maps.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf); <span class="fu">library</span>(tidyverse); <span class="fu">library</span>(tmap)</span>
<span id="cb353-2"><a href="spatial-data-and-maps.html#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb353-3"><a href="spatial-data-and-maps.html#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb353-4"><a href="spatial-data-and-maps.html#cb353-4" aria-hidden="true" tabindex="-1"></a>DEMpath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata/SinkingCove&quot;</span>,<span class="st">&quot;DEM_SinkingCoveUTM.tif&quot;</span>,<span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb353-5"><a href="spatial-data-and-maps.html#cb353-5" aria-hidden="true" tabindex="-1"></a>DEM <span class="ot">&lt;-</span> <span class="fu">raster</span>(DEMpath)</span>
<span id="cb353-6"><a href="spatial-data-and-maps.html#cb353-6" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="fu">terrain</span>(DEM, <span class="at">opt=</span><span class="st">&#39;slope&#39;</span>)</span>
<span id="cb353-7"><a href="spatial-data-and-maps.html#cb353-7" aria-hidden="true" tabindex="-1"></a>aspect <span class="ot">&lt;-</span> <span class="fu">terrain</span>(DEM, <span class="at">opt=</span><span class="st">&#39;aspect&#39;</span>)</span>
<span id="cb353-8"><a href="spatial-data-and-maps.html#cb353-8" aria-hidden="true" tabindex="-1"></a>hillsh <span class="ot">&lt;-</span> <span class="fu">hillShade</span>(slope, aspect, <span class="dv">40</span>, <span class="dv">330</span>)</span>
<span id="cb353-9"><a href="spatial-data-and-maps.html#cb353-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb353-10"><a href="spatial-data-and-maps.html#cb353-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to crop a bit since grid north != true north </span></span>
<span id="cb353-11"><a href="spatial-data-and-maps.html#cb353-11" aria-hidden="true" tabindex="-1"></a>bbox0 <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(DEM)</span>
<span id="cb353-12"><a href="spatial-data-and-maps.html#cb353-12" aria-hidden="true" tabindex="-1"></a>xrange <span class="ot">&lt;-</span> bbox0<span class="sc">$</span>xmax <span class="sc">-</span> bbox0<span class="sc">$</span>xmin</span>
<span id="cb353-13"><a href="spatial-data-and-maps.html#cb353-13" aria-hidden="true" tabindex="-1"></a>yrange <span class="ot">&lt;-</span> bbox0<span class="sc">$</span>ymax <span class="sc">-</span> bbox0<span class="sc">$</span>ymin</span>
<span id="cb353-14"><a href="spatial-data-and-maps.html#cb353-14" aria-hidden="true" tabindex="-1"></a>bbox1 <span class="ot">&lt;-</span> bbox0</span>
<span id="cb353-15"><a href="spatial-data-and-maps.html#cb353-15" aria-hidden="true" tabindex="-1"></a>crop <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb353-16"><a href="spatial-data-and-maps.html#cb353-16" aria-hidden="true" tabindex="-1"></a>bbox1[<span class="dv">1</span>] <span class="ot">&lt;-</span> bbox0[<span class="dv">1</span>] <span class="sc">+</span> crop <span class="sc">*</span> xrange <span class="co"># xmin</span></span>
<span id="cb353-17"><a href="spatial-data-and-maps.html#cb353-17" aria-hidden="true" tabindex="-1"></a>bbox1[<span class="dv">3</span>] <span class="ot">&lt;-</span> bbox0[<span class="dv">3</span>] <span class="sc">-</span> crop <span class="sc">*</span> xrange <span class="co"># xmax</span></span>
<span id="cb353-18"><a href="spatial-data-and-maps.html#cb353-18" aria-hidden="true" tabindex="-1"></a>bbox1[<span class="dv">2</span>] <span class="ot">&lt;-</span> bbox0[<span class="dv">2</span>] <span class="sc">+</span> crop <span class="sc">*</span> yrange <span class="co"># ymin</span></span>
<span id="cb353-19"><a href="spatial-data-and-maps.html#cb353-19" aria-hidden="true" tabindex="-1"></a>bbox1[<span class="dv">4</span>] <span class="ot">&lt;-</span> bbox0[<span class="dv">4</span>] <span class="sc">-</span> crop <span class="sc">*</span> yrange <span class="co"># ymax</span></span>
<span id="cb353-20"><a href="spatial-data-and-maps.html#cb353-20" aria-hidden="true" tabindex="-1"></a>bboxPoly <span class="ot">&lt;-</span> bbox1 <span class="sc">%&gt;%</span> <span class="fu">st_as_sfc</span>() <span class="co"># makes a polygon</span></span>
<span id="cb353-21"><a href="spatial-data-and-maps.html#cb353-21" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb353-22"><a href="spatial-data-and-maps.html#cb353-22" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hillsh, <span class="at">bbox=</span>bboxPoly) <span class="sc">+</span></span>
<span id="cb353-23"><a href="spatial-data-and-maps.html#cb353-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="st">&quot;-Greys&quot;</span>,<span class="at">legend.show=</span>F,<span class="at">n=</span><span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb353-24"><a href="spatial-data-and-maps.html#cb353-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(DEM) <span class="sc">+</span></span>
<span id="cb353-25"><a href="spatial-data-and-maps.html#cb353-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="fu">terrain.colors</span>(<span class="dv">24</span>), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb353-26"><a href="spatial-data-and-maps.html#cb353-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_graticules</span>(<span class="at">lines=</span>F)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p><em>See ?raster to learn more about the rich array of raster GIS operations.</em></p>
</div>
<div id="ggplot2-for-maps" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> ggplot2 for maps</h2>
<p>The Grammar of Graphics is the gg of ggplot.</p>
<ul>
<li>Key concept is separating aesthetics from data</li>
<li>Aesthetics can come from variables (using aes()setting) or be constant for the graph</li>
</ul>
<p>Mapping tools that follow this lead</p>
<ul>
<li>ggplot, as we have seen, and it continues to be enhanced</li>
<li>tmap (Thematic Maps) <a href="https://github.com/mtennekes/tmap" class="uri">https://github.com/mtennekes/tmap</a>
Tennekes, M., 2018, tmap: Thematic Maps in R, <em>Journal of Statistical Software</em> 84(6), 1-39</li>
</ul>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="spatial-data-and-maps.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CA_counties) <span class="sc">+</span> <span class="fu">geom_sf</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<p>Try <code>?geom_sf</code> and you’ll find that its first parameters is mapping with <code>aes()</code> by default. The data property is inherited from the ggplot call, but commonly you’ll want to specify data=something in your geom_sf call.</p>
<p><strong>Another simple ggplot, with labels</strong></p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="spatial-data-and-maps.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CA_counties) <span class="sc">+</span> <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb355-2"><a href="spatial-data-and-maps.html#cb355-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> NAME), <span class="at">size =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p><strong>and now with fill color</strong></p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="spatial-data-and-maps.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CA_counties) <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> MED_AGE)) <span class="sc">+</span></span>
<span id="cb356-2"><a href="spatial-data-and-maps.html#cb356-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> NAME), <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p><strong>Repositioned legend, no “x” or “y” labels</strong></p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="spatial-data-and-maps.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CA_counties) <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill=</span>MED_AGE)) <span class="sc">+</span></span>
<span id="cb357-2"><a href="spatial-data-and-maps.html#cb357-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> NAME), <span class="at">col=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb357-3"><a href="spatial-data-and-maps.html#cb357-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb357-4"><a href="spatial-data-and-maps.html#cb357-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;&quot;</span>,<span class="at">y=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<p><strong>Map in ggplot2, zoomed into two counties [<code>air_quality</code>]:</strong> <span class="citation">(<a href="#ref-TRI" role="doc-biblioref"><em>Toxic Release Inventory (TRI) Program</em>, n.d.</a>)</span>
[Leave out: need new BayAreaTracts]</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="spatial-data-and-maps.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidyverse); library(sf); library(iGIScData)</span></span>
<span id="cb358-2"><a href="spatial-data-and-maps.html#cb358-2" aria-hidden="true" tabindex="-1"></a><span class="co"># census &lt;- BayAreaTracts %&gt;%</span></span>
<span id="cb358-3"><a href="spatial-data-and-maps.html#cb358-3" aria-hidden="true" tabindex="-1"></a><span class="co">#    filter(CNTY_FIPS %in% c(&quot;013&quot;, &quot;095&quot;))</span></span>
<span id="cb358-4"><a href="spatial-data-and-maps.html#cb358-4" aria-hidden="true" tabindex="-1"></a><span class="co"># TRI &lt;- TRI_2017_CA %&gt;%</span></span>
<span id="cb358-5"><a href="spatial-data-and-maps.html#cb358-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   st_as_sf(coords = c(&quot;LONGITUDE&quot;, &quot;LATITUDE&quot;), crs=4326) %&gt;%</span></span>
<span id="cb358-6"><a href="spatial-data-and-maps.html#cb358-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   st_join(census) %&gt;%</span></span>
<span id="cb358-7"><a href="spatial-data-and-maps.html#cb358-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(CNTY_FIPS %in% c(&quot;013&quot;, &quot;095&quot;),</span></span>
<span id="cb358-8"><a href="spatial-data-and-maps.html#cb358-8" aria-hidden="true" tabindex="-1"></a><span class="co">#          (`5.1_FUGITIVE_AIR` + `5.2_STACK_AIR`) &gt; 0)</span></span>
<span id="cb358-9"><a href="spatial-data-and-maps.html#cb358-9" aria-hidden="true" tabindex="-1"></a><span class="co"># bnd = st_bbox(census)</span></span>
<span id="cb358-10"><a href="spatial-data-and-maps.html#cb358-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot() +</span></span>
<span id="cb358-11"><a href="spatial-data-and-maps.html#cb358-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = BayAreaCounties, aes(fill = NAME)) +</span></span>
<span id="cb358-12"><a href="spatial-data-and-maps.html#cb358-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = census, color=&quot;grey40&quot;, fill = NA) +</span></span>
<span id="cb358-13"><a href="spatial-data-and-maps.html#cb358-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf(data = TRI) +</span></span>
<span id="cb358-14"><a href="spatial-data-and-maps.html#cb358-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   coord_sf(xlim = c(bnd[1], bnd[3]), ylim = c(bnd[2], bnd[4])) +</span></span>
<span id="cb358-15"><a href="spatial-data-and-maps.html#cb358-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title=&quot;Census Tracts and TRI air-release sites&quot;) +</span></span>
<span id="cb358-16"><a href="spatial-data-and-maps.html#cb358-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(legend.position = &quot;none&quot;)</span></span></code></pre></div>
<div id="rasters-in-ggplot2" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Rasters in ggplot2</h3>
<p>Raster display in ggplot2 is currently a little awkward, as are rasters in general in the feature-dominated GIS world.</p>
<p>We can use a trick: converting rasters to a grid of points [<strong><code>marbles</code></strong>:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="spatial-data-and-maps.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb359-2"><a href="spatial-data-and-maps.html#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb359-3"><a href="spatial-data-and-maps.html#cb359-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb359-4"><a href="spatial-data-and-maps.html#cb359-4" aria-hidden="true" tabindex="-1"></a>rasPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;elev.tif&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb359-5"><a href="spatial-data-and-maps.html#cb359-5" aria-hidden="true" tabindex="-1"></a>elev <span class="ot">&lt;-</span> <span class="fu">raster</span>(rasPath)</span>
<span id="cb359-6"><a href="spatial-data-and-maps.html#cb359-6" aria-hidden="true" tabindex="-1"></a>shpPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;trails.shp&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb359-7"><a href="spatial-data-and-maps.html#cb359-7" aria-hidden="true" tabindex="-1"></a>trails <span class="ot">&lt;-</span> <span class="fu">st_read</span>(shpPath)</span></code></pre></div>
<pre><code>## Reading layer `trails&#39; from data source 
##   `C:\Users\900008452\Documents\R\win-library\4.0\iGIScData\extdata\trails.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 32 features and 8 fields
## Geometry type: LINESTRING
## Dimension:     XY
## Bounding box:  xmin: 481903.8 ymin: 4599196 xmax: 486901.9 ymax: 4603200
## Projected CRS: NAD83 / UTM zone 10N</code></pre>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="spatial-data-and-maps.html#cb361-1" aria-hidden="true" tabindex="-1"></a>elevpts <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">rasterToPoints</span>(elev))</span>
<span id="cb361-2"><a href="spatial-data-and-maps.html#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb361-3"><a href="spatial-data-and-maps.html#cb361-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> elevpts, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> elev)) <span class="sc">+</span></span>
<span id="cb361-4"><a href="spatial-data-and-maps.html#cb361-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> trails)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
</div>
</div>
<div id="tmap" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> tmap</h2>
<p>Basic building block is tm_shape(data) followed by various layer elements such as tm_fill()
shape can be features or raster.
See Geocomputation with R Chapter 8 “Making Maps with R” for more information.
<a href="https://geocompr.robinlovelace.net/adv-map.html" class="uri">https://geocompr.robinlovelace.net/adv-map.html</a></p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="spatial-data-and-maps.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spData)</span>
<span id="cb362-2"><a href="spatial-data-and-maps.html#cb362-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb362-3"><a href="spatial-data-and-maps.html#cb362-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(world) <span class="sc">+</span> <span class="fu">tm_fill</span>() <span class="sc">+</span> <span class="fu">tm_borders</span>()</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p><strong>Color by variable [<code>air_quality</code>]</strong>
[Leave out: need new BayAreaTracts]</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="spatial-data-and-maps.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(sf)</span></span>
<span id="cb363-2"><a href="spatial-data-and-maps.html#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tmap)</span></span>
<span id="cb363-3"><a href="spatial-data-and-maps.html#cb363-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tm_shape(BayAreaTracts) + tm_fill(col = &quot;MED_AGE&quot;)</span></span></code></pre></div>
<p><strong>tmap of sierraFeb with hillshade and point symbols [<code>sierra</code>]</strong></p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="spatial-data-and-maps.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb364-2"><a href="spatial-data-and-maps.html#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb364-3"><a href="spatial-data-and-maps.html#cb364-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb364-4"><a href="spatial-data-and-maps.html#cb364-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(iGIScData)</span>
<span id="cb364-5"><a href="spatial-data-and-maps.html#cb364-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb364-6"><a href="spatial-data-and-maps.html#cb364-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">max.categories =</span> <span class="dv">8</span>)</span>
<span id="cb364-7"><a href="spatial-data-and-maps.html#cb364-7" aria-hidden="true" tabindex="-1"></a>sierra <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(sierraFeb, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;LONGITUDE&quot;</span>, <span class="st">&quot;LATITUDE&quot;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb364-8"><a href="spatial-data-and-maps.html#cb364-8" aria-hidden="true" tabindex="-1"></a>rasPath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;ca_hillsh_WGS84.tif&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb364-9"><a href="spatial-data-and-maps.html#cb364-9" aria-hidden="true" tabindex="-1"></a>hillsh <span class="ot">&lt;-</span> <span class="fu">raster</span>(rasPath)</span>
<span id="cb364-10"><a href="spatial-data-and-maps.html#cb364-10" aria-hidden="true" tabindex="-1"></a>bounds <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(sierra)</span>
<span id="cb364-11"><a href="spatial-data-and-maps.html#cb364-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hillsh,<span class="at">bbox=</span>bounds)<span class="sc">+</span></span>
<span id="cb364-12"><a href="spatial-data-and-maps.html#cb364-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="st">&quot;-Greys&quot;</span>,<span class="at">legend.show=</span><span class="cn">FALSE</span>,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">+</span> <span class="fu">tm_shape</span>(sierra) <span class="sc">+</span> <span class="fu">tm_symbols</span>(<span class="at">col=</span><span class="st">&quot;TEMPERATURE&quot;</span>,</span>
<span id="cb364-13"><a href="spatial-data-and-maps.html#cb364-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">palette=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="at">style=</span><span class="st">&quot;cont&quot;</span>,<span class="at">n=</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb364-14"><a href="spatial-data-and-maps.html#cb364-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>() <span class="sc">+</span> </span>
<span id="cb364-15"><a href="spatial-data-and-maps.html#cb364-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.position=</span><span class="fu">c</span>(<span class="st">&quot;RIGHT&quot;</span>,<span class="st">&quot;TOP&quot;</span>))</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<p><em>Note: “-Greys” needed to avoid negative image, since “Greys” go from light to dark, and to match reflectance as with b&amp;w photography, they need to go from dark to light.</em></p>
<p><strong><code>UpperSinkingCoveKarst</code></strong></p>
<p>From a hydrologic and geochemical study of a fluviokarstic valley system in Tennessee <span class="citation">(<a href="#ref-davis1993geomorphology" role="doc-biblioref">Jerry D. Davis and Brook 1993</a>)</span>:</p>
<p><img src="img/CaveCoveCaveEntrance.png">
<img src="img/SinkingCoveCave.png">
<img src="img/SinkingCoveCaveSteephead.png"></p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="spatial-data-and-maps.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf); <span class="fu">library</span>(tidyverse); <span class="fu">library</span>(readxl); <span class="fu">library</span>(tmap)</span>
<span id="cb365-2"><a href="spatial-data-and-maps.html#cb365-2" aria-hidden="true" tabindex="-1"></a>wChemData <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/SinkingCove&quot;</span>,<span class="st">&quot;SinkingCoveWaterChem.xlsx&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb365-3"><a href="spatial-data-and-maps.html#cb365-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">siteLoc =</span> <span class="fu">str_sub</span>(Site,<span class="at">start=</span>1L, <span class="at">end=</span>1L))</span>
<span id="cb365-4"><a href="spatial-data-and-maps.html#cb365-4" aria-hidden="true" tabindex="-1"></a>wChemTrunk <span class="ot">&lt;-</span> wChemData <span class="sc">%&gt;%</span> <span class="fu">filter</span>(siteLoc <span class="sc">==</span> <span class="st">&quot;T&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">siteType =</span> <span class="st">&quot;trunk&quot;</span>)</span>
<span id="cb365-5"><a href="spatial-data-and-maps.html#cb365-5" aria-hidden="true" tabindex="-1"></a>wChemDrip <span class="ot">&lt;-</span> wChemData <span class="sc">%&gt;%</span> <span class="fu">filter</span>(siteLoc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;D&quot;</span>,<span class="st">&quot;S&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">siteType =</span> <span class="st">&quot;dripwater&quot;</span>)</span>
<span id="cb365-6"><a href="spatial-data-and-maps.html#cb365-6" aria-hidden="true" tabindex="-1"></a>wChemTrib <span class="ot">&lt;-</span> wChemData <span class="sc">%&gt;%</span> <span class="fu">filter</span>(siteLoc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;P&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">siteType =</span> <span class="st">&quot;tributary&quot;</span>)</span>
<span id="cb365-7"><a href="spatial-data-and-maps.html#cb365-7" aria-hidden="true" tabindex="-1"></a>wChemData <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(wChemTrunk, wChemDrip, wChemTrib)</span>
<span id="cb365-8"><a href="spatial-data-and-maps.html#cb365-8" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata/SinkingCove&quot;</span>, <span class="st">&quot;SinkingCoveSites.csv&quot;</span>, <span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>))</span>
<span id="cb365-9"><a href="spatial-data-and-maps.html#cb365-9" aria-hidden="true" tabindex="-1"></a>wChem <span class="ot">&lt;-</span> wChemData <span class="sc">%&gt;%</span></span>
<span id="cb365-10"><a href="spatial-data-and-maps.html#cb365-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sites, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Site&quot;</span> <span class="ot">=</span> <span class="st">&quot;site&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb365-11"><a href="spatial-data-and-maps.html#cb365-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb365-12"><a href="spatial-data-and-maps.html#cb365-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb365-13"><a href="spatial-data-and-maps.html#cb365-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb365-14"><a href="spatial-data-and-maps.html#cb365-14" aria-hidden="true" tabindex="-1"></a>DEMpath <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata/SinkingCove&quot;</span>,<span class="st">&quot;DEM_SinkingCoveUTM.tif&quot;</span>,<span class="at">package=</span><span class="st">&quot;iGIScData&quot;</span>)</span>
<span id="cb365-15"><a href="spatial-data-and-maps.html#cb365-15" aria-hidden="true" tabindex="-1"></a>DEM <span class="ot">&lt;-</span> <span class="fu">raster</span>(DEMpath)</span>
<span id="cb365-16"><a href="spatial-data-and-maps.html#cb365-16" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="fu">terrain</span>(DEM, <span class="at">opt=</span><span class="st">&#39;slope&#39;</span>)</span>
<span id="cb365-17"><a href="spatial-data-and-maps.html#cb365-17" aria-hidden="true" tabindex="-1"></a>aspect <span class="ot">&lt;-</span> <span class="fu">terrain</span>(DEM, <span class="at">opt=</span><span class="st">&#39;aspect&#39;</span>)</span>
<span id="cb365-18"><a href="spatial-data-and-maps.html#cb365-18" aria-hidden="true" tabindex="-1"></a>hillsh <span class="ot">&lt;-</span> <span class="fu">hillShade</span>(slope, aspect, <span class="dv">40</span>, <span class="dv">330</span>)</span>
<span id="cb365-19"><a href="spatial-data-and-maps.html#cb365-19" aria-hidden="true" tabindex="-1"></a>bounds <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(wChem)</span>
<span id="cb365-20"><a href="spatial-data-and-maps.html#cb365-20" aria-hidden="true" tabindex="-1"></a>xrange <span class="ot">&lt;-</span> bounds<span class="sc">$</span>xmax <span class="sc">-</span> bounds<span class="sc">$</span>xmin</span>
<span id="cb365-21"><a href="spatial-data-and-maps.html#cb365-21" aria-hidden="true" tabindex="-1"></a>yrange <span class="ot">&lt;-</span> bounds<span class="sc">$</span>ymax <span class="sc">-</span> bounds<span class="sc">$</span>ymin</span>
<span id="cb365-22"><a href="spatial-data-and-maps.html#cb365-22" aria-hidden="true" tabindex="-1"></a>xMIN <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bounds<span class="sc">$</span>xmin <span class="sc">-</span> xrange<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb365-23"><a href="spatial-data-and-maps.html#cb365-23" aria-hidden="true" tabindex="-1"></a>xMAX <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bounds<span class="sc">$</span>xmax <span class="sc">+</span> xrange<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb365-24"><a href="spatial-data-and-maps.html#cb365-24" aria-hidden="true" tabindex="-1"></a>yMIN <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bounds<span class="sc">$</span>ymin <span class="sc">-</span> yrange<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb365-25"><a href="spatial-data-and-maps.html#cb365-25" aria-hidden="true" tabindex="-1"></a>yMAX <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bounds<span class="sc">$</span>ymax <span class="sc">+</span> yrange<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb365-26"><a href="spatial-data-and-maps.html#cb365-26" aria-hidden="true" tabindex="-1"></a><span class="co">#st_bbox(c(xmin = 16.1, xmax = 16.6, ymax = 48.6, ymin = 47.9), crs = st_crs(4326))</span></span>
<span id="cb365-27"><a href="spatial-data-and-maps.html#cb365-27" aria-hidden="true" tabindex="-1"></a>newbounds <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin=</span>xMIN, <span class="at">xmax=</span>xMAX, <span class="at">ymin=</span>yMIN, <span class="at">ymax=</span>yMAX), <span class="at">crs=</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>))</span>
<span id="cb365-28"><a href="spatial-data-and-maps.html#cb365-28" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hillsh,<span class="at">bbox=</span>newbounds) <span class="sc">+</span></span>
<span id="cb365-29"><a href="spatial-data-and-maps.html#cb365-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="st">&quot;-Greys&quot;</span>,<span class="at">legend.show=</span>F,<span class="at">n=</span><span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb365-30"><a href="spatial-data-and-maps.html#cb365-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(DEM) <span class="sc">+</span> <span class="fu">tm_raster</span>(<span class="at">palette=</span><span class="fu">terrain.colors</span>(<span class="dv">24</span>), <span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">legend.show=</span>F) <span class="sc">+</span></span>
<span id="cb365-31"><a href="spatial-data-and-maps.html#cb365-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(wChem) <span class="sc">+</span> <span class="fu">tm_symbols</span>(<span class="at">size=</span><span class="st">&quot;TH&quot;</span>, <span class="at">col=</span><span class="st">&quot;Lithology&quot;</span>, <span class="at">scale=</span><span class="dv">2</span>, <span class="at">shape=</span><span class="st">&quot;siteType&quot;</span>) <span class="sc">+</span></span>
<span id="cb365-32"><a href="spatial-data-and-maps.html#cb365-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#tm_legend(legend.outside = T) +</span></span>
<span id="cb365-33"><a href="spatial-data-and-maps.html#cb365-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="sc">+</span></span>
<span id="cb365-34"><a href="spatial-data-and-maps.html#cb365-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_graticules</span>(<span class="at">lines=</span>F)</span></code></pre></div>
<p><img src="EnvDataSci_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
</div>
<div id="interactive-maps" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Interactive Maps</h2>
<p>The word “static” in “static maps” isn’t something you would have heard in a cartography class 30 years ago, since essentially <em>all</em> maps then were static. Very important in designing maps is considering your audience, and one characteristic of the audience of those maps of yore were that they were printed and thus fixed on paper. A lot of cartographic design relates to that property:</p>
<ul>
<li>Figure-to-ground relationships assume “ground” is a white piece of paper (or possibly a standard white background in a pdf), so good cartographic color schemes tend to range from light for low values to dark for high values.</li>
<li>Scale is fixed and there are no “tools” for changing scale, so a lot of attention must be paid to providing scale information.</li>
<li>Similarly, without the ability to see the map at different scales, inset maps are often needed to provide context.</li>
</ul>
<p>Interactive maps change the game in having tools for changing scale, and <em>always</em> being “printed” on a computer or device where the color of the background isn’t necessarily white. We are increasingly used to using interactive maps on our phones or other devices, and often get frustrated not being able to zoom into a static map.</p>
<p>A widely used interactive mapping system is Leaflet, but we’re going to use tmap to access Leaflet behind the scenes and allow us to create maps with one set of commands. The key parameter needed is tmap_mode which must be set to “view” to create an interactive map.</p>
<p>[<strong><code>UpperSinkingCoveKarst</code></strong>]</p>
<p>With an interactive map, we do have the advantage of a good choice of base maps and the ability to resize and explore the map, but symbology is more limited, mostly just color and size, with only one variable in a legend.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="spatial-data-and-maps.html#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;view&quot;</span>)</span>
<span id="cb366-2"><a href="spatial-data-and-maps.html#cb366-2" aria-hidden="true" tabindex="-1"></a>bounds <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>()</span>
<span id="cb366-3"><a href="spatial-data-and-maps.html#cb366-3" aria-hidden="true" tabindex="-1"></a>wChem2map <span class="ot">&lt;-</span> <span class="fu">filter</span>(wChem, Month <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb366-4"><a href="spatial-data-and-maps.html#cb366-4" aria-hidden="true" tabindex="-1"></a>minVal <span class="ot">&lt;-</span> <span class="fu">min</span>(wChem2map<span class="sc">$</span>TH); maxVal <span class="ot">&lt;-</span> <span class="fu">max</span>(wChem2map<span class="sc">$</span>TH)</span>
<span id="cb366-5"><a href="spatial-data-and-maps.html#cb366-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_basemap</span>(leaflet<span class="sc">::</span>providers<span class="sc">$</span>Esri.WorldTopoMap) <span class="sc">+</span> </span>
<span id="cb366-6"><a href="spatial-data-and-maps.html#cb366-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(wChem2map) <span class="sc">+</span> <span class="fu">tm_symbols</span>(<span class="at">col=</span><span class="st">&quot;siteType&quot;</span>, <span class="at">size=</span><span class="st">&quot;TH&quot;</span>, <span class="at">scale=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb366-7"><a href="spatial-data-and-maps.html#cb366-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title=</span><span class="fu">paste</span>(<span class="st">&quot;Total Hardness &quot;</span>,<span class="fu">as.character</span>(minVal),<span class="st">&quot;-&quot;</span>,<span class="fu">as.character</span>(maxVal),<span class="st">&quot; mg/L&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span></code></pre></div>
<div id="htmlwidget-92d6918004277853450f" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-92d6918004277853450f">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircles","args":[[35.04984497,35.05550831,35.05165428,35.0548464,35.05071159,35.05249625,35.05065137,35.05041618,35.05570091,35.05002313,35.04891244,35.05511924,35.05511924,35.04824914,35.05720511,35.05034814,35.05225242,35.05284356,35.05411424,35.04889576,35.05044697,35.06059962,35.0615126,35.05568202,35.04131459,35.06233771,35.06352676,35.06486428,35.06596295],[-86.01369419,-86.00519017,-86.00700342,-86.00671127,-86.00739887,-85.99817925,-86.00598119,-86.01373594,-86.00024908,-86.0176595,-86.01006991,-85.99990376,-85.99990376,-86.00202304,-86.00732013,-86.01545994,-86.00683137,-86.0067784,-86.00681603,-86.02837249,-86.01581609,-86.04003533,-86.0407566,-86.01856506,-86.02094707,-86.04134997,-86.04253228,-86.04228889,-86.04194144],[91.3592294686117,89.7794118536455,87.3561318301044,87.3561318301044,84.0164372947026,83.4468277622985,82.2957819051666,81.7141789855271,79.9439868343255,79.0440258514889,78.1336996094186,77.5208768174798,76.2804627564812,75.0195418150161,72.4318781043197,71.7703859096149,70.766554850855,70.4287650708649,70.4287650708649,66.957207146708,64.0446164831302,60.206058997009,56.9492304736016,53.494487221764,52.5953561734825,50.7493265650641,50.2772295453472,39.0668498047093,15.4425282988232],["D1","D7","D4","D6","D3","K2","K3","T8","T9","T7","D2","B2.1","B2","K1","K4","W7","S4","D5","D5.1","F1","W6","T6","T5","W2","W8","T4","T3","T2","T1"],"wChem2map",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":["#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#FFFFB3","#FFFFB3","#BEBADA","#BEBADA","#BEBADA","#8DD3C7","#FFFFB3","#FFFFB3","#FFFFB3","#FFFFB3","#FFFFB3","#8DD3C7","#8DD3C7","#8DD3C7","#FFFFB3","#FFFFB3","#BEBADA","#BEBADA","#FFFFB3","#FFFFB3","#BEBADA","#BEBADA","#BEBADA","#BEBADA"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>175<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>169<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>160<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>160<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>148<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>146<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>142<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T8<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>140<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T9<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>134<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>131<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>128<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>B2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>126<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>B2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>122<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>118<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>110<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>108<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>S4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>105<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>104<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>104<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>dripwater<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>F1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>94<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>86<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>76<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>68<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>60<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W8<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>58<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>tributary<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>54<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>53<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>32<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>5<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>siteType<\/nobr><\/td><td align=\"right\"><nobr>trunk<\/nobr><\/td><\/tr><\/table><\/div>"],null,["D1","D7","D4","D6","D3","K2","K3","T8","T9","T7","D2","B2","B2","K1","K4","W7","S4","D5","D5","F1","W6","T6","T5","W2","W8","T4","T3","T2","T1"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addLegend","args":[{"colors":["#8DD3C7","#FFFFB3","#BEBADA"],"labels":["dripwater","tributary","trunk"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":"siteType","extra":null,"layerId":"legend401","className":"info legend wChem2map","group":"wChem2map"}]},{"method":"addLayersControl","args":[[],"wChem2map",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[35.04131459,35.06596295],"lng":[-86.04253228,-85.99817925]},"fitBounds":[35.04131459,-86.04253228,35.06596295,-85.99817925,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n\t\t\t\t\t\tfunction(el, x) {\n\t\t\t\t\t\t\tvar tldiv = document.getElementsByClassName(\"leaflet-top leaflet-left\")[0];\n\t\t\t\t\t\t\tvar titlediv = document.createElement('div');\n\t\t\t\t\t\t\ttitlediv.className = \"info legend leaflet-control\";\n\t\t\t\t\t\t\ttitlediv.innerHTML = \"<b>Total Hardness 5-175 mg/L<\/b>\";\n\t\t\t\t\t\t\ttldiv.insertBefore(titlediv, tldiv.childNodes[0]);\n\t\t\t\t\t\t}).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="spatial-data-and-maps.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_basemap</span>(leaflet<span class="sc">::</span>providers<span class="sc">$</span>Esri.WorldTopoMap) <span class="sc">+</span> </span>
<span id="cb367-2"><a href="spatial-data-and-maps.html#cb367-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(wChem2map) <span class="sc">+</span> <span class="fu">tm_symbols</span>(<span class="at">col=</span><span class="st">&quot;Lithology&quot;</span>, <span class="at">size=</span><span class="st">&quot;TH&quot;</span>, <span class="at">scale=</span><span class="dv">2</span>)</span></code></pre></div>
<div id="htmlwidget-74912d2c52dd2b0495a3" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-74912d2c52dd2b0495a3">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.WorldTopoMap",null,"Esri.WorldTopoMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircles","args":[[35.04984497,35.05550831,35.05165428,35.0548464,35.05071159,35.05249625,35.05065137,35.05041618,35.05570091,35.05002313,35.04891244,35.05511924,35.05511924,35.04824914,35.05720511,35.05034814,35.05225242,35.05284356,35.05411424,35.04889576,35.05044697,35.06059962,35.0615126,35.05568202,35.04131459,35.06233771,35.06352676,35.06486428,35.06596295],[-86.01369419,-86.00519017,-86.00700342,-86.00671127,-86.00739887,-85.99817925,-86.00598119,-86.01373594,-86.00024908,-86.0176595,-86.01006991,-85.99990376,-85.99990376,-86.00202304,-86.00732013,-86.01545994,-86.00683137,-86.0067784,-86.00681603,-86.02837249,-86.01581609,-86.04003533,-86.0407566,-86.01856506,-86.02094707,-86.04134997,-86.04253228,-86.04228889,-86.04194144],[91.3592294686117,89.7794118536455,87.3561318301044,87.3561318301044,84.0164372947026,83.4468277622985,82.2957819051666,81.7141789855271,79.9439868343255,79.0440258514889,78.1336996094186,77.5208768174798,76.2804627564812,75.0195418150161,72.4318781043197,71.7703859096149,70.766554850855,70.4287650708649,70.4287650708649,66.957207146708,64.0446164831302,60.206058997009,56.9492304736016,53.494487221764,52.5953561734825,50.7493265650641,50.2772295453472,39.0668498047093,15.4425282988232],["D1","D7","D4","D6","D3","K2","K3","T8","T9","T7","D2","B2.1","B2","K1","K4","W7","S4","D5","D5.1","F1","W6","T6","T5","W2","W8","T4","T3","T2","T1"],"wChem2map",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":["#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#FFFFB3","#FFFFB3","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#8DD3C7","#FFFFB3","#FFFFB3","#FFFFB3","#FFFFB3","#FFFFB3","#FFFFB3","#FFFFB3","#BEBADA"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>175<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>169<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>160<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>160<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>148<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>146<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>142<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T8<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>140<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T9<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>134<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>131<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>128<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>B2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>126<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>B2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>122<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>118<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>K4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>110<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W7<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>108<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>S4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>105<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>104<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>D5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>104<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>F1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>94<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>86<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>limestone<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>76<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T5<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>68<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>60<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>W8<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>58<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T4<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>54<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T3<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>53<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T2<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>32<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>mix<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>T1<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TH<\/nobr><\/td><td align=\"right\"><nobr>5<\/nobr><\/td><\/tr><tr><td style=\"color: #888888;\"><nobr>Lithology<\/nobr><\/td><td align=\"right\"><nobr>sandstone<\/nobr><\/td><\/tr><\/table><\/div>"],null,["D1","D7","D4","D6","D3","K2","K3","T8","T9","T7","D2","B2","B2","K1","K4","W7","S4","D5","D5","F1","W6","T6","T5","W2","W8","T4","T3","T2","T1"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addLegend","args":[{"colors":["#8DD3C7","#FFFFB3","#BEBADA"],"labels":["limestone","mix","sandstone"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":"Lithology","extra":null,"layerId":"legend401","className":"info legend wChem2map","group":"wChem2map"}]},{"method":"addLayersControl","args":[[],"wChem2map",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[35.04131459,35.06596295],"lng":[-86.04253228,-85.99817925]},"fitBounds":[35.04131459,-86.04253228,35.06596295,-85.99817925,[]]},"evals":[],"jsHooks":[]}</script>
<p>[<strong><code>air_quality</code></strong>]
[Leave out: need new BayAreaTracts]</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="spatial-data-and-maps.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tmap_mode(&quot;view&quot;)</span></span>
<span id="cb368-2"><a href="spatial-data-and-maps.html#cb368-2" aria-hidden="true" tabindex="-1"></a><span class="co"># tm_shape(BayAreaTracts) + tm_fill(col = &quot;MED_AGE&quot;, alpha = 0.5)</span></span></code></pre></div>
<p>[<strong><code>sierra</code></strong>]</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="spatial-data-and-maps.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb369-2"><a href="spatial-data-and-maps.html#cb369-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb369-3"><a href="spatial-data-and-maps.html#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;view&quot;</span>)</span>
<span id="cb369-4"><a href="spatial-data-and-maps.html#cb369-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">max.categories =</span> <span class="dv">8</span>)</span>
<span id="cb369-5"><a href="spatial-data-and-maps.html#cb369-5" aria-hidden="true" tabindex="-1"></a>sierra <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(sierraFeb, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;LONGITUDE&quot;</span>, <span class="st">&quot;LATITUDE&quot;</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb369-6"><a href="spatial-data-and-maps.html#cb369-6" aria-hidden="true" tabindex="-1"></a>bounds <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(sierra)</span>
<span id="cb369-7"><a href="spatial-data-and-maps.html#cb369-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_basemap</span>(leaflet<span class="sc">::</span>providers<span class="sc">$</span>Esri.NatGeoWorldMap) <span class="sc">+</span></span>
<span id="cb369-8"><a href="spatial-data-and-maps.html#cb369-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(sierra) <span class="sc">+</span> <span class="fu">tm_symbols</span>(<span class="at">col=</span><span class="st">&quot;TEMPERATURE&quot;</span>,</span>
<span id="cb369-9"><a href="spatial-data-and-maps.html#cb369-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="at">style=</span><span class="st">&quot;cont&quot;</span>,<span class="at">n=</span><span class="dv">8</span>,<span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb369-10"><a href="spatial-data-and-maps.html#cb369-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_legend</span>() <span class="sc">+</span> </span>
<span id="cb369-11"><a href="spatial-data-and-maps.html#cb369-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">legend.position=</span><span class="fu">c</span>(<span class="st">&quot;RIGHT&quot;</span>,<span class="st">&quot;TOP&quot;</span>))</span></code></pre></div>
<div id="htmlwidget-7d2b55de4e0b7e539d13" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-7d2b55de4e0b7e539d13">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.NatGeoWorldMap",null,"Esri.NatGeoWorldMap",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircles","args":[[37.8444,40.1705,35.7831,39.3239,39.4539,36.7394,37.9567,39.49,36.3817,38.2769,39.2041,38.6955,36.465,35.7269,39.2774,40.3458,40.4167,38.2575,40.54111,39.5177,39.9366,36.3278,39.8053,36.9092,39.5633,36.1388,38.2486,39.333,37.3711,39.8716,36.4914,38.8983,36.2032,37.9747,37.0919,38.9072,37.2329,39.2466,39.5833,40.3033,38.0047,39.6911,37.2064,37.9672,37.5122,37.9613,38.3772,36.9969,38.933,36.798,39.563,37.7592,39.7538,39.1678,35.6513,37.75,39.3886,37.2275,36.6044,37.6478,39.0911,38.2119],[-120.2258,-121.0886,-118.4389,-120.2331,-120.6556,-118.9631,-119.1194,-121.61833,-119.0264,-120.3113,-121.068,-120.8244,-118.8619,-118.7006,-120.7102,-121.6091,-120.6631,-119.2286,-121.57667,-121.553,-120.9475,-119.2994,-120.4719,-119.0883,-120.8238,-117.9527,-120.8433,-120.173,-118.358,-121.6108,-118.8253,-119.9947,-119.0545,-119.9161,-119.5128,-121.0838,-119.5097,-121.0008,-120.3705,-121.2422,-120.4863,-121.8211,-119.2419,-120.3872,-119.6331,-119.783,-120.8008,-119.7072,-120.8008,-118.2036,-121.1077,-119.8208,-121.6241,-120.1428,-117.8213,-119.5897,-120.0936,-119.22056,-118.7325,-118.9617,-120.948,-119.0142],[4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799,4052.67134958799],["GROVELAND.2..CA.US","CANYON.DAM..CA.US","KERN.RIVER.PH.3..CA.US","DONNER.MEMORIAL.ST.PARK..CA.US","BOWMAN.DAM..CA.US","GRANT.GROVE..CA.US","LEE.VINING..CA.US","OROVILLE.MUNICIPAL.AIRPORT..CA.US","LEMON.COVE..CA.US","CALAVERAS.BIG.TREES..CA.US","GRASS.VALLEY.NUMBER.2..CA.US","PLACERVILLE..CA.US","THREE.RIVERS.EDISON.PH.1..CA.US","GLENNVILLE..CA.US","BLUE.CANYON.AIRPORT..CA.US","MINERAL..CA.US","SUSANVILLE.2.SW..CA.US","BRIDGEPORT..CA.US","MANZANITA.LAKE..CA.US","OROVILLE..CA.US","QUINCY..CA.US","VISALIA..CA.US","PORTOLA..CA.US","BALCH.POWER.HOUSE..CA.US","DOWNIEVILLE..CA.US","HAIWEE..CA.US","CAMP.PARDEE..CA.US","TRUCKEE.RANGER.STATION..CA.US","BISHOP.AIRPORT..CA.US","DE.SABLA..CA.US","ASH.MOUNTAIN..CA.US","SOUTH.LAKE.TAHOE.AIRPORT..CA.US","LINDSAY..CA.US","CHERRY.VALLEY.DAM..CA.US","AUBERRY.2.NW..CA.US","AUBURN..CA.US","NORTH.FORK.RANGER.STATION..CA.US","NEVADA.CITY..CA.US","SIERRAVILLE.R.S..CA.US","CHESTER..CA.US","NEW.MELONES.DAM.HQ..CA.US","CHICO.UNIVERSITY.FARM..CA.US","BIG.CREEK.PH.1..CA.US","SONORA..CA.US","SO.ENTRANCE.YOSEMITE.N.P...CA.US","HETCH.HETCHY..CA.US","SUTTER.HILL.CDF..CA.US","FRIANT.GOVERNMENT.CAMP..CA.US","GEORGETOWN.R.S..CA.US","INDEPENDENCE..CA.US","STRAWBERRY.VALLEY..CA.US","YOSEMITE.VILLAGE.12.W..CA.US","PARADISE..CA.US","TAHOE.CITY..CA.US","INYOKERN..CA.US","YOSEMITE.PARK.HEADQUARTERS..CA.US","BOCA..CA.US","HUNTINGTON.LAKE..CA.US","LODGEPOLE..CA.US","MAMMOTH.LAKES.RANGER.STATION..CA.US","COLFAX..CA.US","BODIE.CALIFORNIA.STATE.HISTORIC.PARK..CA.US"],"sierra",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":["#890075","#1C00E2","#C90035","#0000FF","#3F00BF","#2300DB","#0700F7","#EA0014","#FF0000","#3D00C1","#9B0063","#D1002D","#DB0023","#93006B","#5E00A0","#1100ED","#3500C9","#0000FF","#0200FC","#F4000A","#5900A5","#F70007","#0A00F4","#D1002D","#750089","#D3002B","#E50019","#0000FF","#82007C","#A0005E","#DD0021","#0000FF","#FC0002","#63009B","#C90035","#DB0023","#A0005E","#960068","#1100ED","#0F00EF","#E50019","#DD0021","#680096","#AF004F","#3500C9","#70008E","#D3002B","#F4000A","#A0005E","#AD0051","#680096","#3500C9","#D3002B","#0000FF","#DD0021","#70008E","#0000FF","#1C00E2","#0000FF","#0000FF","#A50059","#0000FF"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GROVELAND 2, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>6.1<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>CANYON DAM, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>1.4<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>KERN RIVER PH 3, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>8.9<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>DONNER MEMORIAL ST PARK, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>-0.9<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BOWMAN DAM, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>2.9<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GRANT GROVE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>1.7<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>LEE VINING, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>0.4<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>OROVILLE MUNICIPAL AIRPORT, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>10.3<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>LEMON COVE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>11.3<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>CALAVERAS BIG TREES, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>2.7<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GRASS VALLEY NUMBER 2, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>6.9<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>PLACERVILLE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>9.2<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>THREE RIVERS EDISON PH 1, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>9.7<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GLENNVILLE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>6.5<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BLUE CANYON AIRPORT, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>4.1<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>MINERAL, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>0.9<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>SUSANVILLE 2 SW, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>2.4<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BRIDGEPORT, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>-2.2<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>MANZANITA LAKE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>0.2<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>OROVILLE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>10.7<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>QUINCY, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>4.0<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>VISALIA, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>10.9<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>PORTOLA, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>0.5<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BALCH POWER HOUSE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>9.2<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>DOWNIEVILLE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>5.3<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>HAIWEE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>9.3<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>CAMP PARDEE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>10.1<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>TRUCKEE RANGER STATION, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>-1.1<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BISHOP AIRPORT, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>5.7<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>DE SABLA, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>7.1<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>ASH MOUNTAIN, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>9.8<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>SOUTH LAKE TAHOE AIRPORT, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>-0.6<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>LINDSAY, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>11.1<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>CHERRY VALLEY DAM, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>4.4<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>AUBERRY 2 NW, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>8.8<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>AUBURN, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>9.7<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>NORTH FORK RANGER STATION, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>7.2<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>NEVADA CITY, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>6.7<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>SIERRAVILLE R S, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>0.8<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>CHESTER, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>0.7<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>NEW MELONES DAM HQ, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>10.1<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>CHICO UNIVERSITY FARM, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>9.8<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BIG CREEK PH 1, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>4.7<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>SONORA, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>7.7<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>SO ENTRANCE YOSEMITE N.P., CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>2.5<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>HETCH HETCHY, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>4.9<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>SUTTER HILL CDF, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>9.3<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>FRIANT GOVERNMENT CAMP, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>10.8<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>GEORGETOWN R S, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>7.2<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>INDEPENDENCE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>7.6<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>STRAWBERRY VALLEY, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>4.6<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>YOSEMITE VILLAGE 12 W, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>2.5<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>PARADISE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>9.3<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>TAHOE CITY, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>-0.8<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>INYOKERN, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>9.8<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>YOSEMITE PARK HEADQUARTERS, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>5.0<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BOCA, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>-1.4<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>HUNTINGTON LAKE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>1.3<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>LODGEPOLE, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>-1.4<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>MAMMOTH LAKES RANGER STATION, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>-2.3<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>COLFAX, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>7.3<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>BODIE CALIFORNIA STATE HISTORIC PARK, CA US<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TEMPERATURE<\/nobr><\/td><td align=\"right\"><nobr>-4.4<\/nobr><\/td><\/tr><\/table><\/div>"],null,["GROVELAND 2, CA US","CANYON DAM, CA US","KERN RIVER PH 3, CA US","DONNER MEMORIAL ST PARK, CA US","BOWMAN DAM, CA US","GRANT GROVE, CA US","LEE VINING, CA US","OROVILLE MUNICIPAL AIRPORT, CA US","LEMON COVE, CA US","CALAVERAS BIG TREES, CA US","GRASS VALLEY NUMBER 2, CA US","PLACERVILLE, CA US","THREE RIVERS EDISON PH 1, CA US","GLENNVILLE, CA US","BLUE CANYON AIRPORT, CA US","MINERAL, CA US","SUSANVILLE 2 SW, CA US","BRIDGEPORT, CA US","MANZANITA LAKE, CA US","OROVILLE, CA US","QUINCY, CA US","VISALIA, CA US","PORTOLA, CA US","BALCH POWER HOUSE, CA US","DOWNIEVILLE, CA US","HAIWEE, CA US","CAMP PARDEE, CA US","TRUCKEE RANGER STATION, CA US","BISHOP AIRPORT, CA US","DE SABLA, CA US","ASH MOUNTAIN, CA US","SOUTH LAKE TAHOE AIRPORT, CA US","LINDSAY, CA US","CHERRY VALLEY DAM, CA US","AUBERRY 2 NW, CA US","AUBURN, CA US","NORTH FORK RANGER STATION, CA US","NEVADA CITY, CA US","SIERRAVILLE R S, CA US","CHESTER, CA US","NEW MELONES DAM HQ, CA US","CHICO UNIVERSITY FARM, CA US","BIG CREEK PH 1, CA US","SONORA, CA US","SO ENTRANCE YOSEMITE N.P., CA US","HETCH HETCHY, CA US","SUTTER HILL CDF, CA US","FRIANT GOVERNMENT CAMP, CA US","GEORGETOWN R S, CA US","INDEPENDENCE, CA US","STRAWBERRY VALLEY, CA US","YOSEMITE VILLAGE 12 W, CA US","PARADISE, CA US","TAHOE CITY, CA US","INYOKERN, CA US","YOSEMITE PARK HEADQUARTERS, CA US","BOCA, CA US","HUNTINGTON LAKE, CA US","LODGEPOLE, CA US","MAMMOTH LAKES RANGER STATION, CA US","COLFAX, CA US","BODIE CALIFORNIA STATE HISTORIC PARK, CA US"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addLegend","args":[{"colors":["#0000FF , #0000FF 0%, #0000FF 14.2857142857143%, #0200FC 28.5714285714286%, #2D00D1 42.8571428571429%, #5900A5 57.1428571428571%, #8C0072 71.4285714285714%, #B70047 85.7142857142857%, #E2001C 100%, #E2001C "],"labels":["-4","-2","0","2","4","6","8","10"],"na_color":null,"na_label":null,"opacity":1,"position":"topright","type":"numeric","title":"TEMPERATURE","extra":{"p_1":0,"p_n":1},"layerId":"legend401","className":"info legend sierra","group":"sierra"}]},{"method":"addLayersControl","args":[[],"sierra",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[35.6513,40.54111],"lng":[-121.8211,-117.8213]},"fitBounds":[35.6513,-121.8211,40.54111,-117.8213,[]]},"evals":[],"jsHooks":[]}</script>
<p>[<strong><code>landslides</code></strong>]</p>
<p>slideCentroids.shp crs = 26910</p>
<div id="leaflet" class="section level4" number="6.5.0.1">
<h4><span class="header-section-number">6.5.0.1</span> Leaflet</h4>
<p>Now that we’ve seen an app that used it, let’s look briefly at Leaflet itself, and we’ll see that even the Leaflet package in R actually uses JavaScript…</p>
<p>Leaflet is designed as “An open-source JavaScript library for mobile-friendly interactive maps” <a href="https://leafletjs.com" class="uri">https://leafletjs.com</a>
“The <strong>R</strong> package <strong>leaflet</strong> is an interface to the JavaScript library <strong>Leaflet</strong> to create interactive web maps. It was developed on top of the htmlwidgets framework, which means the maps can be rendered in <strong>RMarkdown</strong> (v2) documents (which is why you can see it in this document), Shiny apps, and RStudio IDE / the R console.”</p>
<p><a href="https://blog.rstudio.com/2015/06/24/leaflet-interactive-web-maps-with-r/" class="uri">https://blog.rstudio.com/2015/06/24/leaflet-interactive-web-maps-with-r/</a></p>
<p><a href="https://github.com/rstudio/cheatsheets/blob/master/leaflet.pdf" class="uri">https://github.com/rstudio/cheatsheets/blob/master/leaflet.pdf</a></p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="spatial-data-and-maps.html#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb370-2"><a href="spatial-data-and-maps.html#cb370-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb370-3"><a href="spatial-data-and-maps.html#cb370-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span>  <span class="co"># default OpenStreetMap tiles</span></span>
<span id="cb370-4"><a href="spatial-data-and-maps.html#cb370-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">lng=</span><span class="fl">174.768</span>, <span class="at">lat=</span><span class="sc">-</span><span class="fl">36.852</span>,</span>
<span id="cb370-5"><a href="spatial-data-and-maps.html#cb370-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">popup=</span><span class="st">&quot;The birthplace of R&quot;</span>)</span>
<span id="cb370-6"><a href="spatial-data-and-maps.html#cb370-6" aria-hidden="true" tabindex="-1"></a>m </span></code></pre></div>
<div id="htmlwidget-796c9a98d76675c9469e" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-796c9a98d76675c9469e">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[-36.852,174.768,null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"The birthplace of R",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-36.852,-36.852],"lng":[174.768,174.768]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="exercises-3" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>Using the method of building simple sf geometries, build a simple 1x1 square object and plot it. Remember that you have to close the polygon, so the first vertex is the same as the last (of 5) vertices. Provide your code only.</p></li>
<li><p>Build a map in ggplot of Colorado, Wyoming, and Utah with these boundary vertices in GCS. As with the square, remember to close each figure, and assign the crs to what is needed for GCS: 4326. Submit map as exported plot, and code in the submittal text block. [<strong><code>westUS</code></strong>]</p></li>
</ol>
<ul>
<li>Colorado: (-109,41),(-102,41),(-102,37),(-109,37)</li>
<li>Wyoming: (-111,45),(-104,45),(-104,41),(-111,41)</li>
<li>Utah: (-114,42),(-111,42),(-111,41),(-109,41),(-109,37),(-114,37)</li>
<li>Arizona: (-114,37),(-109,37),(-109,31.3),(-111,31.3),(-114.8,32.5),
(-114.6,32.7),(-114.1,34.3),(-114.5,35),(-114.5,36),(-114,36)</li>
<li>New Mexico: (-109,37),(-103,37),(-103,32),(-106.6,32),(-106.5,31.8),
(-108.2,31.8),(-108.2,31.3),(-109,31.3)</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p>Add in the code for CA and NV and create kind of a western US map…</p></li>
<li><p>Create an sf class from the seven states adding the fields <code>name</code>, <code>abb</code>, <code>area_sqkm</code>, and <code>population</code>, and create a map labeling with the name.</p></li>
</ol>
<ul>
<li>Colorado, CO, 269837, 5758736</li>
<li>Wyoming, WY, 253600, 578759</li>
<li>Utah, UT, 84899, 3205958</li>
<li>Arizona, AZ, 295234, 7278717</li>
<li>New Mexico, NM, 314917, 2096829</li>
<li>California, CA, 423970, 39368078</li>
<li>Nevada, NV, 286382, 3080156</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>Create a tibble for the highest peaks in the 7 states, with the following names, elevations in m, longitude and latitude, and add them to that map:</li>
</ol>
<ul>
<li>Wheeler Peak, 4011, -105.4, 36.5</li>
<li>Mt. Whitney, 4421, -118.2, 36.5</li>
<li>Boundary Peak, 4007, -118.35, 37.9</li>
<li>Kings Peak, 4120, -110.3, 40.8</li>
<li>Gannett Peak, 4209, -109, 43.2</li>
<li>Mt. Elbert, 4401, -106.4, 39.1</li>
<li>Humphreys Peak, 3852, -111.7, 35.4</li>
</ul>
<p>Note: the easiest way to do this is with the tribble function, starting with:</p>
<pre><code>peaks &lt;- tribble(
  ~peak, ~elev, ~longitude, ~latitude,
  &quot;Wheeler Peak&quot;, 4011, -105.4, 36.5,</code></pre>
<ol start="6" style="list-style-type: decimal">
<li><p>Use a spatial join to add the points to the states to provide a new attribute maximum elevation, and display that using geom_sf_text() with the state polygons.</p></li>
<li><p>From the CA_counties and CAfreeways feature data in iGIScData, make a simple map in ggplot, with freeways colored red.</p></li>
<li><p>After adding the raster library, create a raster from the built-in <code>volcano</code> matrix of elevations from Auckland’s Maunga Whau Volcano, and use plot() to display it. We’d do more with that dataset but we don’t know what the cell size is.</p></li>
<li><p>Use tmap to create a simple map from the SW_States (polygons) and peaksp (points) data we created earlier. Hints: you’ll want to use tm_text with text set to “peak” to label the points, along with the parameter <code>auto.placement=TRUE</code>. [<strong><code>westUS</code></strong>]</p></li>
<li><p>Change the map to the view mode, but don’t use the state borders since the basemap will have them. Just before adding shapes, set the basemap to leaflet::providers$Esri.NatGeoWorldMap, then continue to the peaks after the + to see the peaks on a National Geographic basemap.</p></li>
</ol>

</div>
</div>



<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-davis1993geomorphology" class="csl-entry">
Davis, Jerry D, and George A Brook. 1993. <span>“Geomorphology and Hydrology of Upper Sinking Cove, Cumberland Plateau, Tennessee.”</span> <em>Earth Surface Processes and Landforms</em> 18 (4): 339–62.
</div>
<div id="ref-TRI" class="csl-entry">
<em>Toxic Release Inventory (TRI) Program</em>. n.d. U.S. Environmental Protection Agency. <a href="https://www.epa.gov/toxics-release-inventory-tri-program">https://www.epa.gov/toxics-release-inventory-tri-program</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-transformation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistical-summaries-and-tests.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["EnvDataSci.pdf", "EnvDataSci.epub"],
"toc": {
"collapse": "subsection"
},
"book_filename": "envdatasci"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
